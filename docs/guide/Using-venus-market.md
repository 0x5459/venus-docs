# venus-market

venus-market is responsible for deal making for a venus storage system. It compiles into venus-market (provider side) and market-client (lightweight client). Both need chain services and a local wallet to function.

## Quick deployment

Download source code.

```shell script
$ git clone https://github.com/filecoin-project/venus-market.git
```

Compile.

```shell script
$ make deps
$ make
```

Get your <PEER_ID>.

```bash
$ ./venus-market net listen
<PEER_ID>
```

Configure venus-market to allow discovery. 

```bash
$ ./venus-market --repo <REPO_PATH> actor set-addrs <MARKET_URL>
$ ./venus-market actor set-peer-id <PEER_ID>
```

Start venus-market.

```shell script
$ ./venus-market run 
# URL of venus node (part of chain services)
--node-url <NODE_URL> 
# URL of messafer (part of chain services)
--messager-url <MESSAGER_URL> 
# auth token generated by chain services
--auth-token <AUTH_TOKEN>  
# URL of your local wallet
--signer-url <WALLET_URL> 
# token generated by your wallet
--signer-token  <WALLET_TOKEN> 
--piecestorage fs:<PIECE_STORAGE_PATH> 
--miner <MINER_ID>
```

Start client.

```shell script
$ ./market-client run 
# URL of venus node (part of chain services)
--node-url <NODE_URL> 
# URL of messafer (part of chain services)
--messager-url <MESSAGER_URL> 
# auth token generated by chain services
--auth-token <AUTH_TOKEN>  
# URL of your local wallet
--signer-url <WALLET_URL> 
# token generated by your wallet
--signer-token  <WALLET_TOKEN> 
--addr <CLIENT_ADDR>
```

Query price

```bash
$ ./market-client --repo <CLIENT_REPO_PATH> query-ask <MINER_ID>
/data/lotus-data/venus-market-client-calib/
Ask: <MINER_ID>
Price per GiB: 0.0000000005 FIL
Verified Price per GiB: 0.00000000005 FIL
Max Piece size: 32 GiB
Min Piece size: 256 B
```

## Initiate a deal

Initiate a deal.

```shell script
$ ./market-client generate-car <file> <car file>
$ ./market-client import <file>
$ ./market-client deal
```

## Retrieve a deal

Retrieve a deal.

```shell
./market-client retrieve --miner <MINER_ID> <data-cid> <dst path>
```


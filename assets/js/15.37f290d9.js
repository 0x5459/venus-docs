(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{373:function(t,s,a){t.exports=a.p+"assets/img/venus-cluster.2e72d412.png"},392:function(t,s,a){"use strict";a.r(s);var e=a(17),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"venus集群组件介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#venus集群组件介绍"}},[t._v("#")]),t._v(" Venus集群组件介绍")]),t._v(" "),e("p",[t._v("Venus是Filecoin分布式矿池的实现方案之一，系统集群组件包括：Venus，Venus-auth，Venus-miner，Venus-wallet，Venus-messager，Venus-sealer。从概念上理解其中Venus、Venus-auth、Venus-miner、Venus-wallet、Venus-messager具备可共用性（即程序可被多个矿工身份使用，在保证效率的情况下使硬件，软件资源得到充分利用），而Venus-sealer、Venus-worker、Venus-wallet主要用于积累算力。Venus-wallet属于可选组件，基于部署情况的安全性考量，Venus-wallet可以共享使用，也可以本地部署。本篇文档为nerpda测试网络下的集群部署。")]),t._v(" "),e("p",[e("img",{attrs:{src:a(373),alt:"venus-cluster"}})]),t._v(" "),e("h1",{attrs:{id:"venus集群部署-基于nerpa测试网"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#venus集群部署-基于nerpa测试网"}},[t._v("#")]),t._v(" Venus集群部署（基于nerpa测试网）")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("程序")]),t._v(" "),e("th",[t._v("服务器")]),t._v(" "),e("th",[t._v("类型")]),t._v(" "),e("th",[t._v("作用")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("Venus-auth")]),t._v(" "),e("td",[t._v("<IP1>")]),t._v(" "),e("td",[t._v("共享")]),t._v(" "),e("td",[t._v("Venus-auth 用于统一授权，当矿工组件访问共享组件的时候需要使用此服务注册生成的token")])]),t._v(" "),e("tr",[e("td",[t._v("Venus-gateway")]),t._v(" "),e("td",[t._v("<IP2>")]),t._v(" "),e("td",[t._v("共享")]),t._v(" "),e("td",[t._v("桥接部分接口调用")])]),t._v(" "),e("tr",[e("td",[t._v("Venus")]),t._v(" "),e("td",[t._v("<IP3>")]),t._v(" "),e("td",[t._v("共享")]),t._v(" "),e("td",[t._v("Filecoin节点数据同步")])]),t._v(" "),e("tr",[e("td",[t._v("Venus-messager")]),t._v(" "),e("td",[t._v("<IP4>")]),t._v(" "),e("td",[t._v("共享")]),t._v(" "),e("td",[t._v("管理集群中的消息，保证消息上链，控制消息流量，重试等。可对接多个钱包，针对这些钱包做消息管理")])]),t._v(" "),e("tr",[e("td",[t._v("Venus-miner")]),t._v(" "),e("td",[t._v("<IP5>")]),t._v(" "),e("td",[t._v("共享")]),t._v(" "),e("td",[t._v("打包出块消息，可配置多个矿工，会自行计算矿工出块情况，并通过远程访问Venus-sealer获取数据证明")])]),t._v(" "),e("tr",[e("td",[t._v("Venus-wallet")]),t._v(" "),e("td",[t._v("<IP6>")]),t._v(" "),e("td",[t._v("共享")]),t._v(" "),e("td",[t._v("钱包管理，数据签名")])]),t._v(" "),e("tr",[e("td",[t._v("Venus-sealer")]),t._v(" "),e("td",[t._v("<IP7>")]),t._v(" "),e("td",[t._v("非共享")]),t._v(" "),e("td",[t._v("数据封装")])])])]),t._v(" "),e("p",[t._v("Tips:")]),t._v(" "),e("ul",[e("li",[t._v("以下所有"),e("code",[t._v("<>")]),t._v("都是需替换参数，根据自己的实际情况替换")]),t._v(" "),e("li",[t._v("具体版本请自行使用git checkout选择")]),t._v(" "),e("li",[t._v("环境依赖：\n"),e("ul",[e("li",[t._v("golang ^1.15\n"),e("ul",[e("li",[t._v("go env -w GOPROXY=https://goproxy.io,direct")]),t._v(" "),e("li",[t._v("go env -w GO111MODULE=on")])])]),t._v(" "),e("li",[t._v("git")])])])]),t._v(" "),e("h1",{attrs:{id:"云上组件搭建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#云上组件搭建"}},[t._v("#")]),t._v(" 云上组件搭建")]),t._v(" "),e("h2",{attrs:{id:"_1-venus-auth-install"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-venus-auth-install"}},[t._v("#")]),t._v(" 1. Venus-auth Install")]),t._v(" "),e("h3",{attrs:{id:"编译并启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编译并启动"}},[t._v("#")]),t._v(" 编译并启动")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-auth.git\n\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-auth\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" \n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-auth "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" auth.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n")])])]),e("ul",[e("li",[t._v("Venus-auth服务默认配置文件目录为 ~/.venus-auth/config.toml")]),t._v(" "),e("li",[t._v("存储方案默认为badger内嵌kv数据库，也支持MYSQL存储，需要自行修改配置文件后启动。")]),t._v(" "),e("li",[t._v("log存储默为控制台打印，同时支持influxDB存储")])]),t._v(" "),e("h4",{attrs:{id:"mysql存储启动-可选"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql存储启动-可选"}},[t._v("#")]),t._v(" MYSQL存储启动（可选）")]),t._v(" "),e("p",[t._v("Tips: MYSQL支持5.7以上官方版本（如云平台MYSQL默认设置各有不同，请自己结合云平台修改配置，否则可能会出现 “ Specified key was too long; max key length is 767 bytes ”）")]),t._v(" "),e("h5",{attrs:{id:"修改venus-auth-config中的db设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改venus-auth-config中的db设置"}},[t._v("#")]),t._v(" 修改Venus-auth config中的db设置")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ~/.venus-auth/config.toml\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据源配置项")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# support: badger (default), mysql ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# the mysql DDL is in the script package ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The following parameters apply to MySQL")]),t._v("\nDSN "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root:111111@(127.0.0.1:3306)/venus_auth?parseTime=true&loc=Local&charset=utf8mb4&collation=utf8mb4_unicode_ci&readTimeout=10s&writeTimeout=10s"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# conns 1500 concurrent")]),t._v("\nmaxOpenConns "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("\nmaxIdleConns "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v("\nmaxLifeTime "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"120s"')]),t._v("\nmaxIdleTime "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30s"')]),t._v("\n\n")])])]),e("ul",[e("li",[t._v("启动")])]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-auth "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" auth.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),e("h3",{attrs:{id:"注册生成云上组件互相访问需要的token"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#注册生成云上组件互相访问需要的token"}},[t._v("#")]),t._v(" 注册生成云上组件互相访问需要的token")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ ./venus-auth genToken --perm admin admin\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth miner"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),e("ul",[e("li",[e("code",[t._v("<auth token ?>")]),t._v(" 格式统一为 JWT token")]),t._v(" "),e("li",[t._v("这些token之后会被各个程序使用，用以对集群接入组件做验证")]),t._v(" "),e("li",[e("code",[t._v("--perm")]),t._v("为RPC2.0接口访问权限限制")]),t._v(" "),e("li",[t._v("miner，messager，sealer，推荐标记为程序名，若存在多个相同程序要加入集群，可以使用“程序名+标记符”。")])]),t._v(" "),e("h2",{attrs:{id:"_2-venus-gateway-install"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-venus-gateway-install"}},[t._v("#")]),t._v(" 2. Venus-gateway Install")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/ipfs-force-community/venus-gateway.git\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-gateway\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-gateway --listen /ip4/0.0.0.0/tcp/45132 run --auth-url  http://"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth ip"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":8989 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" gateway.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),e("h2",{attrs:{id:"_3-venus-install"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-venus-install"}},[t._v("#")]),t._v(" 3. Venus install")]),t._v(" "),e("h3",{attrs:{id:"安装编译环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装编译环境"}},[t._v("#")]),t._v(" 安装编译环境")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" gcc bzr jq pkgconfig clang llvm mesa-libGL-devel opencl-headers ocl-icd ocl-icd-devel hwloc-devel\n")])])]),e("h3",{attrs:{id:"编译并启动-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编译并启动-2"}},[t._v("#")]),t._v(" 编译并启动")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus.git\n\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deps\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动venus daemon 设置网络与Venus-auth的地址")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动成功后tail -f venus.log 可以看到数据同步的log")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里需要等待一段时间")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus daemon --network nerpa "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--authURL http://"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":8989 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" \n")])])]),e("ul",[e("li",[e("code",[t._v("--authURL")]),t._v(" 为设置Venus-auth监听http地址")])]),t._v(" "),e("h3",{attrs:{id:"修改ipv4监听地址"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改ipv4监听地址"}},[t._v("#")]),t._v(" 修改IPV4监听地址")]),t._v(" "),e("p",[t._v("目前程序启动后默认监听地址为"),e("code",[t._v("127.0.0.1:3453")]),t._v("，对于跨服务器集群，需要修改监听策略，可以通过"),e("code",[t._v("lsof -i:3453")]),t._v(" 查询到进程后，Kill掉进程，修改IPV4策略后重启")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ~/.venus/config.json\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 做如下操作，修改为监听所有本机IPV4地址：")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# replace api.apiAddress from ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# "/ip4/127.0.0.1/tcp/3453"  to  "/ip4/0.0.0.0/tcp/3453"')]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改完毕后重启服务：")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus daemon --network nerpa "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--authURL http://"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":8989 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("absolute path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),e("h2",{attrs:{id:"_4-venus-messager-install"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-venus-messager-install"}},[t._v("#")]),t._v(" 4. Venus-messager install")]),t._v(" "),e("h3",{attrs:{id:"编译并启动-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编译并启动-3"}},[t._v("#")]),t._v(" 编译并启动")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-messager.git\n\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-messager\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deps\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动venus-message 进程")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-messager run "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-url"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":8989 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--gateway-url /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--db-type mysql "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--mysql-dsn "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root:111111@tcp(127.0.0.1:3306)/cali_venus?parseTime=true&loc=Local&readTimeout=10s&writeTimeout=10s"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" msg.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n")])])]),e("ul",[e("li",[e("code",[t._v("--auth-url")]),t._v(" 为设置Venus-auth监听地址")]),t._v(" "),e("li",[e("code",[t._v("--node-url")]),t._v(" 为Venus监听地址")]),t._v(" "),e("li",[e("code",[t._v("--gateway-url")]),t._v(" 为gateway监听地址")]),t._v(" "),e("li",[e("code",[t._v("--auth-token")]),t._v(" 为在venus-auth中生成的管理员token，用于和Venus通信时的身份验证")])]),t._v(" "),e("h2",{attrs:{id:"_5-venus-miner-install"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-venus-miner-install"}},[t._v("#")]),t._v(" 5. Venus-miner install")]),t._v(" "),e("h3",{attrs:{id:"编译并启动-4"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编译并启动-4"}},[t._v("#")]),t._v(" 编译并启动")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-miner.git\n\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-miner\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" nerpanet\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 初始化环境配置")]),t._v("\n$ ./venus-miner init --api /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 --token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token miner"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动miner")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-miner run "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v("miner.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n\n$ ./venus-miner address "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--addr "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--sealer-listen-api /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v("/tcp/2345/http "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--sealer-token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("sealer jwt token"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--wallet-listen-api /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("/tcp/5678/http "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--wallet-token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("wallet jwt token"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# print")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" miner:  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询miner状态")]),t._v("\n$ ./venus-miner address state \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# print")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Addr"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<t0 addr>"')]),t._v(",\n\t\t"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"IsMining"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n\t\t"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Err"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果IsMining为false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 需要执行")]),t._v("\n$ ./venus-miner address start "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 因为miner支持多矿工")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以通过以下指令查看所有关联矿工")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对于矿工的启停可以自行安排")]),t._v("\n$ ./venus-miner address list\n")])])]),e("ul",[e("li",[e("code",[t._v("<t0 addr>")]),t._v("在Venus-sealer install部分查看")]),t._v(" "),e("li",[e("code",[t._v("<sealer jwt token>")]),t._v("为Venus-sealer节点JWT token，切换到对应服务器后"),e("code",[t._v("cat ~/.venussealer/token")]),t._v("可获得")]),t._v(" "),e("li",[e("code",[t._v("<wallet jwt token>")]),t._v(" 为设置Venus-wallet中获得的接口授权JWT token,查看Venus-wallet install中"),e("code",[t._v("<wallet jwt token>")]),t._v("处可查看token如何获得")])]),t._v(" "),e("h1",{attrs:{id:"本地组件搭建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#本地组件搭建"}},[t._v("#")]),t._v(" 本地组件搭建")]),t._v(" "),e("h2",{attrs:{id:"准备工作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[t._v("#")]),t._v(" 准备工作")]),t._v(" "),e("p",[t._v("云上组件需要增加接入的矿工sealer和钱包生成token. 矿工只有凭借这个token才能访问云上的服务。 收钱矿工需要为自己起一个别名, 这里以jimmy为例子。在venus-auth中加入这个矿工，并为矿工生成token")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ venus-auth addUser --name jimmy --miner f"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v("<>")]),t._v("     \n$ venus-auth genToken --perm "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v(" jimmy\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("miner token"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),e("h2",{attrs:{id:"_1-venus-wallet-install"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-venus-wallet-install"}},[t._v("#")]),t._v(" 1. Venus-wallet install")]),t._v(" "),e("h3",{attrs:{id:"编译并启动-5"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编译并启动-5"}},[t._v("#")]),t._v(" 编译并启动")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-wallet.git\n\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-wallet \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编译")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-wallet run "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" wallet.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),e("h3",{attrs:{id:"设置密码并创建钱包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置密码并创建钱包"}},[t._v("#")]),t._v(" 设置密码并创建钱包")]),t._v(" "),e("blockquote",[e("p",[t._v("此处创建了2个BLS钱包，用于之后的Venus-sealer初始化")])]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置加解锁密码")]),t._v("\n$ ./venus-wallet setpwd\nPassword:******\nEnter Password again:******\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成BLS地址")]),t._v("\n$ ./venus-wallet new bls\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("bls address "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v("\n$ ./venus-wallet new bls\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("bls address "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("\n")])])]),e("ul",[e("li",[e("code",[t._v("<bls address 1>")]),t._v(" 为86位长度地址")])]),t._v(" "),e("h4",{attrs:{id:"注意"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[t._v("#")]),t._v(" 注意")]),t._v(" "),e("p",[t._v("新生成的"),e("code",[t._v("<bls address 1>")]),t._v(" "),e("code",[t._v("<bls address 2>")]),t._v("需要到https://faucet.nerpa.interplanetary.dev/funds.html中预充balance后才能在链上生成actor。")]),t._v(" "),e("h3",{attrs:{id:"修改配置文件并重启"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件并重启"}},[t._v("#")]),t._v(" 修改配置文件并重启")]),t._v(" "),e("div",{staticClass:"language-toml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-toml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default config:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("API")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("ListenAddress")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/0.0.0.0/tcp/5678/http"')]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("DB")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Conn")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/root/.venus_wallet/keystore.sqlit"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Type")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sqlite"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("DebugMode")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("JWT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"65794a68624763694f694a49557a49314e694973496e523563434936496b705856434a392e65794a42624778766479493657794a795a57466b4969776964334a70644755694c434a7a615764754969776959575274615734695858302e7a534c6755446565514e6473716f666179415235445a6f4b4f48787742566855364c635636716154586663"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Secret")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"96d3bbf96ee0151a0495146bccd4825e81e12c24ed8307456a286066a610d52d"')]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Factor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("ScryptN")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("262144")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("ScryptP")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Strategy")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Level")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("NodeURL")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("APIRegisterHub")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("   //修改此处 上面勿动\n"),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("RegisterAPI")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/<IP2>/tcp/45132"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<miner token>"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("SupportAccounts")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jimmy"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("h2",{attrs:{id:"_2-venus-sealer-install"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-venus-sealer-install"}},[t._v("#")]),t._v(" 2. Venus-sealer install")]),t._v(" "),e("h3",{attrs:{id:"编译并启动-sealer单程序只能绑定一个矿工"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编译并启动-sealer单程序只能绑定一个矿工"}},[t._v("#")]),t._v(" 编译并启动（sealer单程序只能绑定一个矿工）")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-sealer.git\n\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-sealer\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deps\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),e("h4",{attrs:{id:"初始化新矿工-2选1"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#初始化新矿工-2选1"}},[t._v("#")]),t._v(" 初始化新矿工（2选1）")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-sealer init "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--worker "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("bls address "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--owner "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("bls address "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--sector-size 512M "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--network nerpa "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--messager-url /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--gateway-url /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--no-local-storage "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--wallet-name testminer "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" sealer.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n")])])]),e("h4",{attrs:{id:"初始化已存在矿工-2选1"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#初始化已存在矿工-2选1"}},[t._v("#")]),t._v(" 初始化已存在矿工（2选1）")]),t._v(" "),e("blockquote",[e("p",[t._v("不需要指定"),e("code",[t._v("--sector-size")])])]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ ./venus-sealer init "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--actor "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--network nerpa "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--messager-url /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--gateway-url /ip4/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--no-local-storage "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--wallet-name testminer \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看日志等待消息上链注册actor地址")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:31.925+0800\tINFO\tmain\tvenus-sealer/init.go:182\tChecking "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" repo exists\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:31.926+0800\tINFO\tmain\tvenus-sealer/init.go:217\tChecking full node version\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:31.927+0800\tINFO\tmain\tvenus-sealer/init.go:233\tInitializing repo\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:31.928+0800\tINFO\tmain\tvenus-sealer/init.go:309\tInitializing libp2p identity\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:32.082+0800\tINFO\tmain\tvenus-sealer/init.go:485\tPushed CreateMiner message: aaf489f9-af4b-4e4b-9084-018d43f05b7e\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:32.082+0800\tINFO\tmain\tvenus-sealer/init.go:486\tWaiting "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" confirmation\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:46:32.088+0800\tINFO\tmain\tvenus-sealer/init.go:502\tNew miners address is: t01640 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t2cxzf7xvrqo3froqn2xgdqjdbydhkcrgakj7j3ma"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:46:32.088+0800\tINFO\tmain\tvenus-sealer/init.go:381\tCreated new miner: t01640\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:46:32.089+0800\tINFO\tmain\tvenus-sealer/init.go:302\tSealer successfully created, you can now start it with "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'venus-sealer run'")]),t._v("\n\n")])])]),e("ul",[e("li",[e("code",[t._v("<bls address 1>")]),t._v(" "),e("code",[t._v("<bls address 2>")]),t._v(" 为Venus-wallet中创建的BLS钱包地址，注意这2个钱包地址都需要有balance")]),t._v(" "),e("li",[e("code",[t._v("<miner token>")]),t._v("为Venus-auth中注册的sealer")]),t._v(" "),e("li",[e("code",[t._v("<absolute path>")]),t._v("为绝对路径")])]),t._v(" "),e("h4",{attrs:{id:"启动sealer并执行sector封装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动sealer并执行sector封装"}},[t._v("#")]),t._v(" 启动sealer并执行sector封装")]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-sealer run "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" sealer.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定存储目录(可选)")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 因为指定了--no-local-storage")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 所以需要指定sealer存储目录")]),t._v("\n$ ./venus-sealer storage attach --init --store --seal "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("absolute path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行sector封装，这个命令只支持单次")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以通过crontab 做定时任务，也可以自行编写策略脚本执行")]),t._v("\n$ ./venus-sealer sectors pledge \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看sector列表")]),t._v("\n$ ./venus-sealer sectors list\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看actor地址")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里为<t0 addr>")]),t._v("\n$ ./venus-sealer info\n\nChain: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sync ok"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("basefee "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(" aFIL"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nSealer: "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("512")]),t._v(" MiB sectors"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nPower: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("  / "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" Ti "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0000")]),t._v("%"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tRaw: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" B / "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),t._v(" TiB "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0000")]),t._v("%"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tCommitted: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" GiB\n\tProving: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" B\nBelow minimum power threshold, no blocks will be won\nSealer Balance:    "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("383.869")]),t._v(" FIL\n      PreCommit:  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n      Pledge:     "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("93.75")]),t._v(" mFIL\n      Vesting:    "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n      Available:  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("383.775")]),t._v(" FIL\nMarket Balance:   "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n       Locked:    "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n       Available: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nWorker Balance:   "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" FIL\nTotal Spendable:  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1383.775")]),t._v(" FIL\n")])])]),e("h2",{attrs:{id:"_7-问题相关"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-问题相关"}},[t._v("#")]),t._v(" 7. 问题相关")]),t._v(" "),e("ol",[e("li",[t._v("go mod 出先如下问题")])]),t._v(" "),e("div",{staticClass:"language-shell script extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("SECURITY ERROR\nThis download does NOT match an earlier download recorded "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" go.sum.\nThe bits may have been replaced on the origin server, or an attacker may\nhave intercepted the download attempt.\n\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解决方案")]),t._v("\ngo clean -modcache\ngo mod tidy\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);